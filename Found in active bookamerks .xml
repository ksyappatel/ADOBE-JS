<?xml version="1.0" encoding="UTF-8"?>
<Commands>
	<Command name="JavaScript" pauseBefore="false" promptUser="false" label="Found in active bookamerks " tooltip="Found in active bookamerks " ID="1542ff47142347f6afd373429ae97c86">
		<Items>
			<Item name="ScriptCode" type="text" value="function checkBookmarks(bookmarksList) {&#xD;&#xA;    var inactiveBookmarks = [];&#xD;&#xA;    var inactiveSubBookmarks = [];&#xD;&#xA;&#xD;&#xA;    for (var i = 0; i &lt; bookmarksList.length; i++) {&#xD;&#xA;        var bookmark = bookmarksList[i];&#xD;&#xA;        var originalPage = this.pageNum; // Store the original page number&#xD;&#xA;&#xD;&#xA;        // Attempt to execute the bookmark&#xD;&#xA;        try {&#xD;&#xA;            bookmark.execute();&#xD;&#xA;            // Check if the page has changed after execution&#xD;&#xA;            if (this.pageNum === originalPage) {&#xD;&#xA;                inactiveBookmarks.push(bookmark.name); // Add to inactive bookmarks list&#xD;&#xA;            }&#xD;&#xA;        } catch (e) {&#xD;&#xA;            // If execution fails, consider the bookmark inactive&#xD;&#xA;            inactiveBookmarks.push(bookmark.name);&#xD;&#xA;        }&#xD;&#xA;&#xD;&#xA;        // Reset to the original page&#xD;&#xA;        this.pageNum = originalPage;&#xD;&#xA;&#xD;&#xA;        // Check for sub-bookmarks recursively&#xD;&#xA;        if (bookmark.children &amp;&amp; bookmark.children.length &gt; 0) {&#xD;&#xA;            var subResult = checkBookmarks(bookmark.children);&#xD;&#xA;            inactiveSubBookmarks = inactiveSubBookmarks.concat(subResult.inactiveBookmarks);&#xD;&#xA;            inactiveSubBookmarks = inactiveSubBookmarks.concat(subResult.inactiveSubBookmarks);&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    // Return both inactive bookmarks and sub-bookmarks&#xD;&#xA;    return {&#xD;&#xA;        inactiveBookmarks: inactiveBookmarks,&#xD;&#xA;        inactiveSubBookmarks: inactiveSubBookmarks&#xD;&#xA;    };&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;// Get the root bookmarks and check for inactive ones&#xD;&#xA;var myBookmarksList = this.bookmarkRoot.children;&#xD;&#xA;var result = checkBookmarks(myBookmarksList);&#xD;&#xA;&#xD;&#xA;// Prepare the message for the alert&#xD;&#xA;var totalInactive = result.inactiveBookmarks.length + result.inactiveSubBookmarks.length;&#xD;&#xA;var message = &quot;Total Inactive Bookmarks: &quot; + totalInactive + &quot;\n\n&quot;;&#xD;&#xA;&#xD;&#xA;if (result.inactiveBookmarks.length &gt; 0) {&#xD;&#xA;    message += &quot;Main Inactive Bookmarks:\n&quot; + result.inactiveBookmarks.join(&quot;\n&quot;) + &quot;\n\n&quot;;&#xD;&#xA;} else {&#xD;&#xA;    message += &quot;No main inactive bookmarks found.\n\n&quot;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (result.inactiveSubBookmarks.length &gt; 0) {&#xD;&#xA;    message += &quot;Sub Inactive Bookmarks:\n&quot; + result.inactiveSubBookmarks.join(&quot;\n&quot;);&#xD;&#xA;} else {&#xD;&#xA;    message += &quot;No sub inactive bookmarks found.&quot;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;// Display the alert message&#xD;&#xA;app.alert(message, 3);"/>
		</Items>
	</Command>
</Commands>
